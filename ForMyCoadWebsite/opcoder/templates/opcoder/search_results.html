{% extends 'opcoder/base.html' %}
{% block body %}
{% load static %}

<link rel="stylesheet" href="{% static '/opcoder/css/video_playing.css' %}">

<h1>Site Search</h1>

<form method="GET" action="{% url 'search_view' %}">
    <input type="text" name="slug" placeholder="Search titles..." value="{{ query|default_if_none:'' }}" required>
    <button type="submit">Search</button>
</form>

{% if query %}
    <h2>Results for: "{{ query }}"</h2>

    {% with total_results=blog_results|length|add:video_results|length %}
        <p>Found {{ total_results }} relevant items.</p>
    {% endwith %}

    <h3>Blogs ({{ blog_results|length }})</h3>
    {% if blog_results %}
        <ol>
            {% for blog in blog_results %}
                <li>
                    <a href="{% url 'blogpost' blog.slug %}">{{ blog.title }}</a>
                </li>
            {% endfor %}
        </ol>
    {% else %}
        <p>No matching blogs found.</p>
    {% endif %}

    <h3>Videos ({{ video_results|length }})</h3>
    {% if video_results %}
    <div class="media">
        {% for v in video_results %}
        <div class="video_cards">
            <img class="thumbnail" src="{{MEDIA_URL}}{{v.thumbnail.url}}" onclick="location.href = '/video_playing/{{v.slug}}'">
            <div>
                <h2><a class="ctitle" href="/video_playing/{{v.slug}}">{{v.title}}</a></h2>
                <div>
                    <p class="cdata">views {{v.tviews}} | Likes {{v.tlikes}}</p>
                    <p class="cdata">{{v.date.date}}</p>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
        <p>No matching videos found.</p>
    {% endif %}

{% else %}
    <p>Enter a term to begin your site search.</p>
{% endif %}

{% endblock body %}